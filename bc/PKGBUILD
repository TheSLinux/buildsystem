# Maintainer: Severus <severus@theslinux.org>
# Original Maitainer: dorphell <dorphell@archlinux.org>

pkgdesc="An arbitrary precision calculator language"
arch=('i686' 'x86_64')
url="http://www.gnu.org/software/bc/"
license=('GPL')
depends=('readline')
replaces=('bc-readline')
conflicts=('bc-readline')
install=bc.install
source=("ftp://ftp.gnu.org/gnu/${pkgbase}/${pkgbase}-${pkgver}.tar.gz"
        'build-fix.patch' 'bc-1.06-info-dir-entry.patch')

build() {
  export CFLAGS="${CFLAGS/-O?/-O3}"

  cd "${srcdir}/${pkgbase}-${pkgver}"
  patch -p1 -i "${srcdir}/build-fix.patch"
  patch -p1 -i "${srcdir}/bc-1.06-info-dir-entry.patch"

  ./configure --prefix=/usr --mandir=/usr/share/man \
    --infodir=/usr/share/info --with-readline
  make LEX="flex -I"
}

package() {
  cd "${srcdir}/${pkgbase}-${pkgver}"
  make DESTDIR="${pkgdir}" install
}
